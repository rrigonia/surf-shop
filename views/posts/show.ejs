<% layout('layouts/post-show-layout') %>
    <h1>Show page</h1>
    <div id='map' style='width: 400px; height: 300px;'></div>
    <h2>
        <%=post.title%>
    </h2>
    <div>Price: <%=post.price%>
    </div>
    <div>Description: <%=post.description%>
    </div>
    <div>Location: <%=post.location%>
    </div>
    <div>
        <% if(post.images.length) {%>
            <% for(image of post.images) {%>
                <img src="<%=image.little%>" alt="">
                <% } %>
                    <% } %>
    </div>
    <div>
        <a href="/posts/<%=post._id%>/edit">
            <button>Edit</button>
        </a>
    </div>
    <div>
        <form action="/posts/<%=post._id%>?_method=DELETE" method="POST">
            <input type="submit" value="Delete">
        </form>
    </div>

    <h2>Create a Review</h2>
    <form action="/posts/<%=post._id%>/reviews" method="POST">
        <textarea name="review[body]" id="" cols="30" rows="5" required></textarea>
        <input name="review[rating]" type="number" min="1" max="5" step="1" required>
        <input type="submit">
    </form>

    <h3>Reviews</h3>
    <% for(let review of post.reviews) {%>
        <div>
            <h5>
                <%= review.author.username %>
            </h5>
            <p>Rating: <%= review.rating %> - <%= review.body %>
            </p>
            
        </div>
        <% if(review.author.equals(currentUser._id)) {%> 
        <div>
            <button class="toggle-edit-form">Edit</button>

            <form action="/posts/<%=post._id%>/reviews/<%=review._id%>?_method=PUT" method="POST" class="edit-review-form">
                <textarea name="review[body]" id="" cols="30" rows="5" required><%= review.body %></textarea>
                <input name="review[rating]" type="number" min="1" max="5" step="1" value="<%= review.rating %>" required>
                <input type="submit" value="Update">
            </form>
        </div>
        <% }; %> 
        <hr>
        <% }; %>